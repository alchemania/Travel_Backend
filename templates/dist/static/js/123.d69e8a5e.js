"use strict";(self["webpackChunkvue_big_screen_plugin"]=self["webpackChunkvue_big_screen_plugin"]||[]).push([[123],{4123:function(e,l,a){a.r(l),a.d(l,{default:function(){return w}});a(9932);var t=a(5916),d=a(3141),u=a(1484),n=a(8558),o=a(348),s=a(4769),i=a(671),r=a(8928),m=a.n(r),c=a(4609),v=a(4734);const p=(0,t.Lk)("div",{class:"title"},"模型部署面板 ML Panel",-1),b={class:"card-header"},k={class:"sub-title"},f={class:"text item"},_={class:"text item"},g={class:"text item"},F={class:"text item"},V={class:"text item"},h={class:"text item"},y={class:"time"};var S={__name:"mlManage",setup(e){const l=(0,u.KR)(!1),a=(0,u.KR)(!1),r=(0,u.KR)(!1),S=(0,u.KR)([]),W=(0,u.KR)([]),w=(0,u.KR)({name:"ml_nmainland_bilstm_32_r1",module:".h5",driver:"TensorFlow",dataSource:"data_nonmainland",dataSpan:[],lastForecast:"2023-05-26T17:36:21",lastUpdate:"2023-05-27T14:02:32",loss:.49636754393577576,precision:.7083333134651184,isSwitchedOn:!1,modelStatus:"latest",hyperParameters:{}}),U=e=>{const l=e.data;let a=[];l.forEach((e=>{const l={...e,dataSpan:[m()(e.dataLearnedBegin).toDate(),m()(e.dataLearnedEnd).toDate()]};delete l.dataLearnedBegin,delete l.dataLearnedEnd,a.push(l)})),console.log(a),S.value=a};(0,t.KC)((()=>{s.A.get(i.hT).then((e=>{U(e)}))}));const L=()=>{n.s.confirm("提示:本模型会被下线，重新上线之前数据库的数据并不会更新","Model Warning",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((()=>{l.value=!l.value;let e={...w.value,dataLearnedBegin:(0,v.f)(w.value.dataSpan[0],"yyyy-MM-dd"),dataLearnedEnd:(0,v.f)(w.value.dataSpan[1],"yyyy-MM-dd")};for(const l in e.hyperParameters)e.hyperParameters[l]=Number(e.hyperParameters[l]);delete e.dataSpan,e.modelStatus="offline",console.log(e),s.A.post(i.OS,e).then((e=>{U(e),(0,o.df)({title:"模型更新通知",message:"刷新已提交",duration:0,type:"success"})})).catch((()=>{(0,o.df)({title:"模型更新通知",message:"服务器内部错误",duration:0,type:"error"})}))}))},x=e=>{Object.assign(w.value,e),l.value=!l.value},C=e=>{n.s.confirm("提交后数据库中数据将被自动异步刷新，建议在刷新前监视模型预测数据","Forecast Warning",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((()=>{s.A.post(i.as,{id:e.id}).then((e=>{console.log(e),(0,o.df)({title:"数据更新通知",message:"刷新已提交",duration:0,type:"success"})}))}))},X=e=>{a.value=!a.value,r.value=!r.value,s.A.post(i.FW,{id:e.id}).then((e=>{console.log(e),W.value=e.data["insight"],r.value=!r.value}))};return(e,n)=>{const o=(0,t.g2)("el-tag"),s=(0,t.g2)("el-button"),i=(0,t.g2)("el-card"),m=(0,t.g2)("el-col"),v=(0,t.g2)("el-row"),U=(0,t.g2)("el-input"),E=(0,t.g2)("el-form-item"),K=(0,t.g2)("el-switch"),P=(0,t.g2)("el-date-picker"),T=(0,t.g2)("el-tooltip"),R=(0,t.g2)("el-form"),B=(0,t.g2)("el-drawer"),M=(0,t.g2)("el-table-column"),O=(0,t.g2)("el-table"),A=(0,t.gN)("loading");return(0,t.uX)(),(0,t.CE)("div",null,[p,(0,t.bF)(v,{gutter:20},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(S.value,(e=>((0,t.uX)(),(0,t.Wv)(m,{span:8},{default:(0,t.k6)((()=>[(0,t.bF)(i,{shadow:"hover"},{header:(0,t.k6)((()=>[(0,t.Lk)("div",b,[(0,t.Lk)("span",k,(0,d.v_)(e.name),1),!0===e.isSwitchedOn?((0,t.uX)(),(0,t.Wv)(o,{key:0,class:"ml-1",type:"success"},{default:(0,t.k6)((()=>[(0,t.eW)("已接入")])),_:1})):((0,t.uX)(),(0,t.Wv)(o,{key:1,class:"ml-1",type:"warning"},{default:(0,t.k6)((()=>[(0,t.eW)("未接入")])),_:1})),"offline"===e.modelStatus?((0,t.uX)(),(0,t.Wv)(o,{key:2,class:"ml-2",type:"info"},{default:(0,t.k6)((()=>[(0,t.eW)("已下线")])),_:1})):"latest"===e.modelStatus?((0,t.uX)(),(0,t.Wv)(o,{key:3,class:"ml-2",type:"success"},{default:(0,t.k6)((()=>[(0,t.eW)("最新")])),_:1})):"useful"===e.modelStatus?((0,t.uX)(),(0,t.Wv)(o,{key:4,class:"ml-2",type:"warning"},{default:(0,t.k6)((()=>[(0,t.eW)("基本可用")])),_:1})):((0,t.uX)(),(0,t.Wv)(o,{key:5,class:"ml-2",type:"danger"},{default:(0,t.k6)((()=>[(0,t.eW)("已过时")])),_:1}))]),(0,t.bF)(s,{class:"button",text:"",onClick:l=>x(e),style:{"align-items":"end"}},{default:(0,t.k6)((()=>[(0,t.eW)("更新模型 ")])),_:2},1032,["onClick"]),(0,t.bF)(s,{class:"button",text:"",onClick:l=>C(e),style:{"align-items":"end"}},{default:(0,t.k6)((()=>[(0,t.eW)("更新预测数据 ")])),_:2},1032,["onClick"]),(0,t.bF)(s,{class:"button",text:"",onClick:l=>X(e),style:{"align-items":"end"}},{default:(0,t.k6)((()=>[(0,t.eW)("查看预测数据 ")])),_:2},1032,["onClick"])])),default:(0,t.k6)((()=>[(0,t.Lk)("div",f,"推理库: "+(0,d.v_)(e.driver),1),(0,t.Lk)("div",_,"模型类型: "+(0,d.v_)(e["module"]),1),(0,t.Lk)("div",g,"模型ID: "+(0,d.v_)(e.id),1),(0,t.Lk)("div",F,"数据来源表: "+(0,d.v_)(e.dataSource),1),(0,t.Lk)("div",V,"上次预测时间: "+(0,d.v_)(e.lastForecast),1),(0,t.Lk)("div",h,"预测跨度: "+(0,d.v_)(e.hyperParameters.PRED_LENGTH),1),(0,t.Lk)("time",y," 更新时间: "+(0,d.v_)(e.lastUpdate),1)])),_:2},1024)])),_:2},1024)))),256))])),_:1}),(0,t.bF)(B,{modelValue:l.value,"onUpdate:modelValue":n[12]||(n[12]=e=>l.value=e),title:"详细信息","with-header":!0},{footer:(0,t.k6)((()=>[(0,t.bF)(s,{type:"primary",onClick:L},{default:(0,t.k6)((()=>[(0,t.eW)("提交变更")])),_:1}),(0,t.bF)(s,{onClick:n[11]||(n[11]=e=>l.value=!l.value)},{default:(0,t.k6)((()=>[(0,t.eW)("取消变更")])),_:1})])),default:(0,t.k6)((()=>[(0,t.bF)(R,{model:w.value,"label-width":"140px"},{default:(0,t.k6)((()=>[(0,t.bF)(E,{label:"模型名称"},{default:(0,t.k6)((()=>[(0,t.bF)(U,{modelValue:w.value.name,"onUpdate:modelValue":n[0]||(n[0]=e=>w.value.name=e),clearable:""},null,8,["modelValue"])])),_:1}),(0,t.bF)(E,{label:"模型编号"},{default:(0,t.k6)((()=>[(0,t.bF)(U,{modelValue:w.value.id,"onUpdate:modelValue":n[1]||(n[1]=e=>w.value.id=e),disabled:""},null,8,["modelValue"])])),_:1}),(0,t.bF)(E,{label:"是否接入"},{default:(0,t.k6)((()=>[(0,t.bF)(K,{modelValue:w.value.isSwitchedOn,"onUpdate:modelValue":n[2]||(n[2]=e=>w.value.isSwitchedOn=e),"active-icon":(0,u.R1)(c.Jlk),"inactive-icon":(0,u.R1)(c.bm)},null,8,["modelValue","active-icon","inactive-icon"])])),_:1}),(0,t.bF)(E,{label:"推理库"},{default:(0,t.k6)((()=>[(0,t.bF)(U,{modelValue:w.value.driver,"onUpdate:modelValue":n[3]||(n[3]=e=>w.value.driver=e),disabled:""},null,8,["modelValue"])])),_:1}),(0,t.bF)(E,{label:"模型类型"},{default:(0,t.k6)((()=>[(0,t.bF)(U,{modelValue:w.value.module,"onUpdate:modelValue":n[4]||(n[4]=e=>w.value.module=e),disabled:""},null,8,["modelValue"])])),_:1}),(0,t.bF)(E,{label:"数据来源表"},{default:(0,t.k6)((()=>[(0,t.bF)(U,{modelValue:w.value.dataSource,"onUpdate:modelValue":n[5]||(n[5]=e=>w.value.dataSource=e),disabled:""},null,8,["modelValue"])])),_:1}),(0,t.bF)(E,{label:"预测跨度"},{default:(0,t.k6)((()=>[(0,t.bF)(P,{modelValue:w.value.dataSpan,"onUpdate:modelValue":n[6]||(n[6]=e=>w.value.dataSpan=e),type:"daterange","range-separator":"To","start-placeholder":"Start date","end-placeholder":"End date"},null,8,["modelValue"])])),_:1}),(0,t.bF)(E,{label:"上次模型更新时间"},{default:(0,t.k6)((()=>[(0,t.bF)(P,{modelValue:w.value.lastForecast,"onUpdate:modelValue":n[7]||(n[7]=e=>w.value.lastForecast=e),type:"datetime",placeholder:"Select date and time",disabled:""},null,8,["modelValue"])])),_:1}),(0,t.bF)(E,{label:"上次数据更新时间"},{default:(0,t.k6)((()=>[(0,t.bF)(P,{modelValue:w.value.lastUpdate,"onUpdate:modelValue":n[8]||(n[8]=e=>w.value.lastUpdate=e),type:"datetime",placeholder:"Select date and time",disabled:""},null,8,["modelValue"])])),_:1}),(0,t.bF)(E,{label:"准确率"},{default:(0,t.k6)((()=>[(0,t.bF)(U,{modelValue:w.value.precision,"onUpdate:modelValue":n[9]||(n[9]=e=>w.value.precision=e),disabled:""},null,8,["modelValue"])])),_:1}),(0,t.bF)(E,{label:"损失率"},{default:(0,t.k6)((()=>[(0,t.bF)(U,{modelValue:w.value.loss,"onUpdate:modelValue":n[10]||(n[10]=e=>w.value.loss=e),disabled:""},null,8,["modelValue"])])),_:1}),((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(w.value.hyperParameters,((e,l)=>((0,t.uX)(),(0,t.Wv)(E,{label:l},{default:(0,t.k6)((()=>[(0,t.bF)(T,{effect:"dark",content:"请不要在不清楚其作用的情况下修改超参数，此举有可能导致严重的模型训练错误",placement:"left"},{default:(0,t.k6)((()=>[(0,t.bF)(U,{modelValue:w.value.hyperParameters[l],"onUpdate:modelValue":e=>w.value.hyperParameters[l]=e,clearable:""},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024)])),_:2},1032,["label"])))),256))])),_:1},8,["model"])])),_:1},8,["modelValue"]),(0,t.bF)(B,{modelValue:a.value,"onUpdate:modelValue":n[13]||(n[13]=e=>a.value=e),title:"预测数据内省","with-header":!0,size:"50%"},{default:(0,t.k6)((()=>[(0,t.bo)(((0,t.uX)(),(0,t.Wv)(O,{data:W.value},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(W.value[0],((e,l)=>((0,t.uX)(),(0,t.Wv)(M,{prop:l,label:l,width:"150px"},null,8,["prop","label"])))),256))])),_:1},8,["data"])),[[A,r.value]])])),_:1},8,["modelValue"])])}}};const W=S;var w=W}}]);
//# sourceMappingURL=123.d69e8a5e.js.map